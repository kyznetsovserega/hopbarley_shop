{% extends "base.html" %}
{% load static %}

{% block content %}

<main class="checkout-page-wrapper">
    <div class="checkout-container">
        <h1 class="checkout-title">Order Details</h1>

        <form method="post" id="checkout-form">
            {% csrf_token %}

            {# === Django messages (корзина) === #}
            {% if messages %}
                <div class="messages">
                    {% for msg in messages %}
                        <p class="{{ msg.tags }}">{{ msg }}</p>
                    {% endfor %}
                </div>
            {% endif %}

            {% if error %}
                <div class="checkout-error">
                    <p>{{ error }}</p>
                </div>
            {% endif %}

            {# === Ошибки Django-формы === #}
            {% if form.errors %}
                <div class="checkout-error">

                    {# Ошибки по каждому полю #}
                    {% for field in form %}
                        {% for error in field.errors %}
                            <p>{{ error }}</p>
                        {% endfor %}
                    {% endfor %}

                    {# Ошибки всей формы #}
                    {% for error in form.non_field_errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}

            {# === Shipping info === #}
            <section class="checkout-section">
                <h2 class="checkout-section__title">Shipping information</h2>

                <div class="checkout-form-group">
                    {{ form.full_name.label_tag }}
                    {{ form.full_name }}
                </div>

                <div class="checkout-form-group">
                    {{ form.email.label_tag }}
                    {{ form.email }}
                </div>

                <div class="checkout-form-group">
                    {{ form.phone.label_tag }}
                    {{ form.phone }}
                </div>

                <div class="checkout-form-group">
                    {{ form.shipping_address.label_tag }}
                    {{ form.shipping_address }}
                </div>

                <div class="checkout-form-group">
                    {{ form.comment.label_tag }}
                    {{ form.comment }}
                </div>
            </section>

            {# === Payment === #}
            <section class="checkout-section">
                <h2 class="checkout-section__title">Payment Method</h2>
                <div class="payment-options">
                    {{ form.payment_method }}
                </div>
            </section>

            {# === Summary === #}
            <section class="checkout-summary">
                <h2 class="checkout-section__title">Order Summary</h2>

                <div class="summary-total">
                    <p>Total:</p>
                    <p>{{ cart_total }}₽</p>
                </div>

                <button type="submit" class="button button--primary button--pay">
                    Pay
                </button>
            </section>

        </form>
    </div>
</main>

{% endblock %}
